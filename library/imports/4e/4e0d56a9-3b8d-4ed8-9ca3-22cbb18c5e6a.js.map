{"version":3,"sources":["assets\\Scripts\\NovaBlock.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class NewClass extends cc.Component {\r\n\r\n    Board: cc.Node = null\r\n    Ngang: number = null\r\n    Doc: number = null\r\n    PreviousNgang: number = null\r\n    PreviousDoc: number = null\r\n    CoTheDat = false\r\n    BoardComponent: any = null\r\n    flickingBlock: any = null\r\n    BlockBoard: cc.Node = null\r\n\r\n    onLoad()\r\n    {\r\n        this.Board = cc.find('Canvas/Screen2/Board')\r\n        this.BoardComponent = this.Board.getComponent(\"Board\")\r\n        this.node.on(cc.Node.EventType.TOUCH_START, this.onTouchStart, this)\r\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, this.onTouchMove, this)\r\n        this.node.on(cc.Node.EventType.TOUCH_END, this.onTouchEnd, this)\r\n        this.BlockBoard = cc.find('Canvas/Screen2/Board/BlockBoard')\r\n        console.log(\"Dakhoitao\")\r\n        // this.node.getComponent(cc.Animation).play(\"FlickingNovaBlock\")\r\n        this.node.getComponent(cc.Animation).play(\"NovaChangeColor\")\r\n        this.flickingBlock= function (block: cc.Node)\r\n        {\r\n            block.opacity = 100\r\n            cc.tween(block).to(0.4,{opacity:255}).to(0.4,{opacity:100}).start()\r\n        }\r\n        \r\n    }\r\n\r\n    onTouchStart()\r\n    {\r\n        this.Board.getComponent(\"Board\").zIndex +=1\r\n        this.node.zIndex = this.Board.getComponent(\"Board\").zIndex\r\n        this.BlockBoard.sortAllChildren()\r\n    }\r\n\r\n    onTouchMove(event)\r\n    {\r\n        let touch = event.getTouches()[0]\r\n        let touch_pos = touch.getLocation()\r\n        let standard_touch_pos = this.Board.convertToNodeSpaceAR(touch_pos)\r\n        this.node.setPosition(standard_touch_pos)\r\n        \r\n    }\r\n\r\n    onTouchEnd()\r\n    {\r\n        if(this.CoTheDat)\r\n        {\r\n            let n = this.Ngang\r\n            let d = this.Doc\r\n            // this.Board.getComponent(\"Board\").BlockArray[this.BlockArray[i].getComponent(\"Block\").Ngang][this.BlockArray[i].getComponent(\"Block\").Doc].destroy()\r\n            // this.BoardComponent.BlockArray[n][d] = this.BlockArray[i]\r\n            // this.BoardComponent.EmptyBlockArray[n][d].scale = 0\r\n            // this.BoardComponent.Prepos[n][d] = 1\r\n            // this.BoardComponent.IndexColorArray[n][d] = this.IndexColor\r\n            this.node.setPosition(this.Board.getComponent(\"Board\").VTNgang[this.Doc],this.Board.getComponent(\"Board\").VTDoc[this.Ngang])\r\n            this.BoardComponent.checkAnDiem()\r\n            for(let i=-1;i<2;i++)\r\n            {\r\n                for(let j=-1;j<2;j++)\r\n                {\r\n                    if(this.Ngang+i<8&&this.Ngang+i>=0&&this.Doc+j<8&&this.Doc+j>=0)\r\n                    {\r\n                        if(this.BoardComponent.Prepos[this.Ngang+i][this.Doc+j] == 1&&!(i==0&&j==0))\r\n                        {\r\n                            this.BoardComponent.EmptyBlockArray[this.Ngang+i][this.Doc+j].scale = 1\r\n                            cc.tween(this.BoardComponent.BlockArray[this.Ngang+i][this.Doc+j]).to(0.1,{opacity:0}).call(()=>{\r\n                                this.BoardComponent.BlockArray[this.Ngang+i][this.Doc+j].destroy()\r\n                            }).start()\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            this.BoardComponent.taoBlockNgauNhien()\r\n            cc.tween(this.node).to(0.1,{opacity:0}).call(()=>{\r\n                this.node.destroy()\r\n            }).start()\r\n        }\r\n        else\r\n        {\r\n            cc.tween(this.node).to(0.1,{x:0,y:-430}).start()\r\n        }\r\n    }\r\n\r\n    onCollisionEnter(other, self)\r\n    {\r\n        // console.log(other.tag)\r\n        if (other.tag == 1)\r\n        {\r\n            this.CoTheDat = true\r\n            // console.log('va cham voi empty')\r\n            \r\n            this.Ngang = other.getComponent(\"EmptyBlock\").Ngang\r\n            this.Doc = other.getComponent(\"EmptyBlock\").Doc\r\n            // console.log(other.getComponent(\"EmptyBlock\").Ngang,other.getComponent(\"EmptyBlock\").Doc)\r\n            // console.log(this.Ngang,this.Doc)\r\n            // this.BoardComponent.Prepos[this.Ngang][this.Doc] = 1\r\n            for(let i=-1;i<2;i++)\r\n            {\r\n                for(let j=-1;j<2;j++)\r\n                {\r\n                    if(this.Ngang+i<8&&this.Ngang+i>=0&&this.Doc+j<8&&this.Doc+j>=0)\r\n                    {\r\n                        if(this.BoardComponent.Prepos[this.Ngang+i][this.Doc+j] == 1&&!(i==0&&j==0))\r\n                        {\r\n                            // cc.tween(this.BoardComponent.BlockArray[this.Ngang+i][this.Doc+j]).to(0.1,{scale:1.3}).start()\r\n                            this.BoardComponent.BlockArray[this.Ngang+i][this.Doc+j].scale = 1.3\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (other.tag == 3)\r\n        {\r\n            this.CoTheDat = true\r\n        }\r\n    }\r\n    \r\n    \r\n\r\n    onCollisionExit(other, self)\r\n    {\r\n        if (other.tag == 3)\r\n        {\r\n            // console.log('exit va cham voi empty')\r\n            console.log(\"Huy va cham\")\r\n            this.CoTheDat = false\r\n        }\r\n        if (other.tag == 1)\r\n        {\r\n            this.CoTheDat = false\r\n            // this.BoardComponent.Prepos[this.Ngang][this.Doc] = 0\r\n            for(let i=-1;i<2;i++)\r\n            {\r\n                for(let j=-1;j<2;j++)\r\n                {\r\n                    if(this.Ngang+i<8&&this.Ngang+i>=0&&this.Doc+j<8&&this.Doc+j>=0)\r\n                    {\r\n                        if(this.BoardComponent.Prepos[this.Ngang+i][this.Doc+j] == 1&&!(i==0&&j==0))\r\n                        {\r\n                            // cc.tween(this.BoardComponent.BlockArray[this.Ngang+i][this.Doc+j]).to(0.1,{scale:1}).start()\r\n                            this.BoardComponent.BlockArray[this.Ngang+i][this.Doc+j].scale = 1\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            this.Ngang = null\r\n            this.Doc = null\r\n            \r\n            \r\n            \r\n        //     this.Ngang = null\r\n        //     this.Doc = null\r\n        }\r\n    }\r\n    turnOffListener()\r\n    {\r\n        this.node.off(cc.Node.EventType.TOUCH_START, this.onTouchStart, this)\r\n        this.node.off(cc.Node.EventType.TOUCH_MOVE, this.onTouchMove, this)\r\n        this.node.off(cc.Node.EventType.TOUCH_END, this.onTouchEnd, this)\r\n    }\r\n    // update()\r\n    // {\r\n    //     console.log(\"Vi tri hien tai la: \" + this.Ngang + \" \" + this.Doc)\r\n    // }\r\n}\r\n"]}